<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Chess</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">
  <link rel="stylesheet" href="styles.css">
  <script src="scripts.js"></script>

</head>

<script>

  var currentIndex = 0;
  var currentSelection = "";
  var playersTurn = true;
  var playerPieces = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15];
  var opponentPieces = [48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63];

  function createButtons() {

    var s = '';
    var red = true;

    var index = 0;

    for (i = 0; i < 8; i++) {
      for (j = 0; j < 8; j++) {

        s += '<button value="' + index++ + '" onclick="buttonOnClick(this.value)" id="close-image" style="background-color: ';

        if (red)
          s += '#D4C4C4; ';       
        else // gray
          s += '#D87D7D; ';
        
        red = !red;

        s += 'left: ' + (560 + j * 100).toString() + 'px; ';
        s += 'top: ' + (100 + i * 100).toString() + 'px; border-color: white">';
        s += '</button>';      
      }
      red = !red; // alternate color on next row
    }

    s += '<button class="button_new" onclick="newOnClick()" style="background-color: gray; position: absolute; left: 860px; top: 20px; width: 200px; height: 50px; font-size: 20pt; font-weight: bold;">New Game</button>';
    document.body.innerHTML = s;
    setDefaultImages();
  }

  function moveOppponent() {


  }

  function setButtonBorder(i, width, color) {
    var btn = document.getElementsByTagName('button')[i];

    if (btn == null)
      return;

    btn.style.borderWidth = width + 'px';
    btn.style.borderColor = color;
  }

  function buttonOnClick(index) {

    if (!playersTurn) {
      moveOppponent();
      //return;
    }

    var buttons = document.getElementsByTagName('button');

    if (buttons[index].style.borderColor === 'gray') {
      // move selected piece
      var image = buttons[currentIndex].getElementsByTagName('img')[0];
      image.parentElement.removeChild(image);
      buttons[index].appendChild(image);
      playerPieces[playerPieces.indexOf(+currentIndex)] = +index;
      setButtonBorder(index, 2, 'white');
      setButtonBorder(currentIndex, 2, 'white');
      clearMoves();
      playersTurn = false;
      return;
    }
    else {
      // don't allow selection on imageless buttons
      var i = buttons[index].getElementsByTagName('img')[0];
      if (i == null)
        return;
    }

    clearMoves();

    setButtonBorder(currentIndex, 2, 'white');
    currentIndex = index;
    setButtonBorder(currentIndex, 5, 'red');

    var i = buttons[currentIndex].getElementsByTagName('img')[0];

    if (i != null) {
      getMove(i.src.toString());
    }
    else {
      currentSelection = "";
    }
  }

  function getMove(s) {

    var buttons = document.getElementsByTagName('button');

    if (s.includes('pawn')) {

        currentSelection = "pawn";
        var startingIndexes =  [8, 9, 10, 11, 12, 13, 14, 15];

        // one space forward
        if (!playerPieces.includes(+currentIndex + 8)) {
          setButtonBorder(+currentIndex + 8, 5, 'gray');

          if (startingIndexes.includes(+currentIndex)) {
            // allow two spaces forward on first move
            setButtonBorder(+currentIndex + 16, 5, 'gray');
            }
          }
      }
      else if (s.includes('rook')) {
        currentSelection = "rook";
      }
      else if (s.includes('knight')) {
        currentSelection = "knight";
      }
      else if (s.includes('bishop')) {
        currentSelection = "bishop";
      }
      else if (s.includes('queen')) {
        currentSelection = "queen";
      }
      else if (s.includes('king')) {
        if (!playerPieces.includes(+currentIndex + 8))
          setButtonBorder(+currentIndex + 8, 5, 'gray');

        if (!playerPieces.includes(+currentIndex - 8))
          setButtonBorder(+currentIndex - 8, 5, 'gray');

        if (!playerPieces.includes(+currentIndex + 1))   
          setButtonBorder(+currentIndex + 1, 5, 'gray');

        if (!playerPieces.includes(+currentIndex - 1))
          setButtonBorder(+currentIndex - 1, 5, 'gray');

        currentSelection = "king";
      }
  }

  function setVerticalMoves() {
    while (true) {

    }
  }

  function setHorizontalMoves() {

  }

  function clearMoves() {
    for (i = 0; i < 64; i++) {
      var btn = document.getElementsByTagName('button')[i];
      if (btn.style.borderColor === 'gray')
        btn.style.borderWidth = '2px';
        btn.style.borderColor = 'white';
      }
  }

  function setDefaultImages() {

      var buttons = document.getElementsByTagName('button');

      buttons[0].appendChild(getImage('rook'));
      buttons[1].appendChild(getImage('knight'));
      buttons[2].appendChild(getImage('bishop'));
      buttons[3].appendChild(getImage('king'));
      buttons[4].appendChild(getImage('queen'));
      buttons[5].appendChild(getImage('bishop'));
      buttons[6].appendChild(getImage('knight'));
      buttons[7].appendChild(getImage('rook'));

      for (i = 8; i < 16; i++) {
        buttons[i].appendChild(getImage('pawn'));
      }

      for (i = 48; i < 56; i++) {
        buttons[i].appendChild(getImage('pawn'));
      }

      buttons[56].appendChild(getImage('rook'));
      buttons[57].appendChild(getImage('knight'));
      buttons[58].appendChild(getImage('bishop'));
      buttons[59].appendChild(getImage('king'));
      buttons[60].appendChild(getImage('queen'));
      buttons[61].appendChild(getImage('bishop'));
      buttons[62].appendChild(getImage('knight'));
      buttons[63].appendChild(getImage('rook'));
  }

  function getImage(piece) {
      var image = document.createElement('image');
      image.innerHTML = '<img src="' + piece + '.png">';
      return image;
  }

  function newOnClick() {
    createButtons();
    playerPieces = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15];
    opponentPieces = [48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63];
  }
</script>

<body onload="createButtons()">
  <!-- 
  <button id="close-image"><img src="rook.png"></button>
  <button id="close-CSS"></button>
  -->
  
  <!--
  <button id="close-image" style="background-color: #D4C4C4; left: 560px; top: 100px;"><img src="rook.png"></button>
  <button id="close-image" style="background-color: #D87D7D; left: 660px; top: 100px;"><img src="rook.png"></button>
  <button style="background-color: #D4C4C4; left: 760px; top: 100px;"></button>
  <button style="background-color: #D87D7D; left: 860px; top: 100px;"></button>
  <button style="background-color: #D4C4C4; left: 960px; top: 100px;"></button>
  <button style="background-color: #D87D7D; left: 1060px; top: 100px;"></button>
  <button style="background-color: #D4C4C4; left: 1160px; top: 100px;"></button>
  <button style="background-color: #D87D7D; left: 1260px; top: 100px;"></button>

  <button style="background-color: #D87D7D; left: 560px; top: 200px;"></button>
  <button style="background-color: #D4C4C4; left: 660px; top: 200px;"></button>
  <button style="background-color: #D87D7D; left: 760px; top: 200px;"></button>
  <button style="background-color: #D4C4C4; left: 860px; top: 200px;"></button>
  <button style="background-color: #D87D7D; left: 960px; top: 200px;"></button>
  <button style="background-color: #D4C4C4; left: 1060px; top: 200px;"></button>
  <button style="background-color: #D87D7D; left: 1160px; top: 200px;"></button>
  <button style="background-color: #D4C4C4; left: 1260px; top: 200px;"></button>

  <button style="background-color: #D4C4C4; left: 560px; top: 300px;"></button>
  <button style="background-color: #D87D7D; left: 660px; top: 300px;"></button>
  <button style="background-color: #D4C4C4; left: 760px; top: 300px;"></button>
  <button style="background-color: #D87D7D; left: 860px; top: 300px;"></button>
  <button style="background-color: #D4C4C4; left: 960px; top: 300px;"></button>
  <button style="background-color: #D87D7D; left: 1060px; top: 300px;"></button>
  <button style="background-color: #D4C4C4; left: 1160px; top: 300px;"></button>
  <button style="background-color: #D87D7D; left: 1260px; top: 300px;"></button>

  <button style="background-color: #D87D7D; left: 560px; top: 400px;"></button>
  <button style="background-color: #D4C4C4; left: 660px; top: 400px;"></button>
  <button style="background-color: #D87D7D; left: 760px; top: 400px;"></button>
  <button style="background-color: #D4C4C4; left: 860px; top: 400px;"></button>
  <button style="background-color: #D87D7D; left: 960px; top: 400px;"></button>
  <button style="background-color: #D4C4C4; left: 1060px; top: 400px;"></button>
  <button style="background-color: #D87D7D; left: 1160px; top: 400px;"></button>
  <button style="background-color: #D4C4C4; left: 1260px; top: 400px;"></button>

  <button style="background-color: #D4C4C4; left: 560px; top: 500px;"></button>
  <button style="background-color: #D87D7D; left: 660px; top: 500px;"></button>
  <button style="background-color: #D4C4C4; left: 760px; top: 500px;"></button>
  <button style="background-color: #D87D7D; left: 860px; top: 500px;"></button>
  <button style="background-color: #D4C4C4; left: 960px; top: 500px;"></button>
  <button style="background-color: #D87D7D; left: 1060px; top: 500px;"></button>
  <button style="background-color: #D4C4C4; left: 1160px; top: 500px;"></button>
  <button style="background-color: #D87D7D; left: 1260px; top: 500px;"></button>

  <button style="background-color: #D87D7D; left: 560px; top: 600px;"></button>
  <button style="background-color: #D4C4C4; left: 660px; top: 600px;"></button>
  <button style="background-color: #D87D7D; left: 760px; top: 600px;"></button>
  <button style="background-color: #D4C4C4; left: 860px; top: 600px;"></button>
  <button style="background-color: #D87D7D; left: 960px; top: 600px;"></button>
  <button style="background-color: #D4C4C4; left: 1060px; top: 600px;"></button>
  <button style="background-color: #D87D7D; left: 1160px; top: 600px;"></button>
  <button style="background-color: #D4C4C4; left: 1260px; top: 600px;"></button>

  <button style="background-color: #D4C4C4; left: 560px; top: 700px;"></button>
  <button style="background-color: #D87D7D; left: 660px; top: 700px;"></button>
  <button style="background-color: #D4C4C4; left: 760px; top: 700px;"></button>
  <button style="background-color: #D87D7D; left: 860px; top: 700px;"></button>
  <button style="background-color: #D4C4C4; left: 960px; top: 700px;"></button>
  <button style="background-color: #D87D7D; left: 1060px; top: 700px;"></button>
  <button style="background-color: #D4C4C4; left: 1160px; top: 700px;"></button>
  <button style="background-color: #D87D7D; left: 1260px; top: 700px;"></button>

  <button style="background-color: #D87D7D; left: 560px; top: 800px;"></button>
  <button style="background-color: #D4C4C4; left: 660px; top: 800px;"></button>
  <button style="background-color: #D87D7D; left: 760px; top: 800px;"></button>
  <button style="background-color: #D4C4C4; left: 860px; top: 800px;"></button>
  <button style="background-color: #D87D7D; left: 960px; top: 800px;"></button>
  <button style="background-color: #D4C4C4; left: 1060px; top: 800px;"></button>
  <button style="background-color: #D87D7D; left: 1160px; top: 800px;"></button>
  <button style="background-color: #D4C4C4; left: 1260px; top: 800px;"></button>

-->
</body>
</html>